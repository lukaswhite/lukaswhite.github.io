<!doctype html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">

<!--
••••••••••••••••••••••••

Powered by Type & Grids™
www.typeandgrids.com

••••••••••••••••••••••••
-->

<title>Lukas White // Web Developer // Blog</title>
<meta name="description" content="The website of Lukas White, Manchester-based Freelance Web Designer and Developer">
<meta name="author" content="Lukas White">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- CSS
================================================================================================= -->
<link rel="stylesheet" href="/dist/styles.min.css">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Favicons
================================================================================================= -->
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" href="images/favicons/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="images/favicons/apple-touch-icon-114x114.png">

</head>
<body>

<div class="container">
  
  <!-- Header begins ========================================================================== -->
  <header id="page-header" class="sixteen columns">
    <div id="logo">
      <a href="/">
        <h1>Lukas White</h1>
        <h2>Freelance Web Developer</h2>
      </a>
      <!--
      <img src="images/logo.png" width="275" height="35" alt="Logo" />
      -->
    </div>
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/work">Work</a></li>
        <li><a href="/contact">Contact</a></li>        
      </ul>
    </nav>
    <hr />
  </header>
  <!-- Header ends ============================================================================ -->
  
  <div id="content" class="content">
  <div id="blog">  

	<div class="eleven columns post">

		<h2>Blog</h2>

		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/seven-useful-drupal-modules-enhance-usability-administrators">Seven Useful Drupal Modules to Enhance Usability for Administrators</a></h3>		    		
				<p class="meta"> &ndash; 24<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>One of Drupal’s weaknesses, I feel, is that out-of-the-box usability for administrators is a little poor (the Drupal team themselves would probably agree with me, however this is something that’s now being addressed in a big way). There are, however, plenty of ways to make the experience better through a set of Drupal modules which I’ll be covering in this post. However before even thinking about modules, it’s important you have a good admin theme – and there are a few good options. <a href="http://drupal.org/project/rootcandy">Rootcandy</a> is a perennial favourite, and comes in three flavours; standard, fixed (i.e. a fixed width) and dark. </p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/seven-useful-drupal-modules-enhance-usability-administrators">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/drupal-6-install-profile-fail-call-undefined-function-dbresult-pathinc">Drupal 6 Install Profile Fail: Call to undefined function db_result() in path.inc</a></h3>		    		
				<p class="meta"> &ndash; 23<sup>rd</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>I’ve just spent hours trying to get an install profile to work, which was giving me this error: </p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/drupal-6-install-profile-fail-call-undefined-function-dbresult-pathinc">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/drupal-7-drupal_execute-has-gone-say-hello-to-drupal_form_submit">Drupal 7: drupal_execute has Gone, Say Hello to drupal_form_submit</a></h3>		    		
				<p class="meta"> &ndash; 17<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>As has been commented elsewhere, when you’re programmatically inserting data the most reliable way of doing so is often to simulate form submission – that way, any validation rules are applied and other modules have a chance to intercept the submission to do what they need to with the data. This </p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/drupal-7-drupal_execute-has-gone-say-hello-to-drupal_form_submit">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/using-additional-database-drupal-7">Using an Additional Database in Drupal 7</a></h3>		    		
				<p class="meta"> &ndash; 16<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>One of the nice, lesser-known features of Drupal 7 is the ability to use additional databases and switch at ease. This might be useful for external databases, or if you have another database in an alternative format – perhaps you have an SQLite database that for performance reasons, you don’t wish to migrate. (Yes, Drupal 7 now supports SQLite!) The configuration can be a little confusing at first, so let’s look at a <code>settings.php</code> file set up to use two databases: <code>drupal</code> on <code>Localhost</code>, and <code>db2</code> situated at <code>db.example.com</code>.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$databases</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> 
  <span class="k">array</span> <span class="p">(</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> 
    <span class="k">array</span> <span class="p">(</span>
      <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;drupal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span>
      <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
      <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
      <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="s1">&#39;driver&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
      <span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">),</span>
  <span class="p">),</span>
  <span class="s1">&#39;external&#39;</span> <span class="o">=&gt;</span> 
  <span class="k">array</span> <span class="p">(</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> 
    <span class="k">array</span> <span class="p">(</span>
      <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;db1&#39;</span><span class="p">,</span>
      <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;username2&#39;</span><span class="p">,</span>
      <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password2&#39;</span><span class="p">,</span>
      <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;db.example.com&#39;</span><span class="p">,</span>
      <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="s1">&#39;driver&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span>
      <span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">),</span>
  <span class="p">),</span>
<span class="p">);</span></code></pre></div>

<p>The file is fairly self-explanatory – the default database is called <code>drupal</code> and the second database is keyed <code>external</code> (i.e., the <strong>connection key</strong>). The confusion might lie in the nested <code>default</code>. In addition to allowing additional, separate databases, Drupal now allows master/slave configurations. In the example above the second level <code>default</code> is the <strong>target</strong>, and refers to the <em>master</em> server – as does the second. If you examine the code it can become quite easy to confuse whether <code>default</code> refers to the default database, the master database or the additional, master database. (perhaps <code>master</code> would have been a better term?) just remember, connection key followed by target. Switching databases in your code is simple: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nx">db_set_active</span><span class="p">(</span><span class="s1">&#39;external&#39;</span><span class="p">);</span></code></pre></div>

<p>Any subsequent database operations (for example, <code>db_select</code>) will now take place on your second database. There’s a caveat – you <em>must</em> switch back to the default database when you’ve done. Otherwise you’ll get tell-tale error; a “Base table or view not found”, usually something like one of Drupal’s cache tables, or commonly the <code>block</code> table – either way, the error message will tell you it’s your database as the table names will be prefixed with the schema in the error message. Switching back to the default database is easy; no key is required as the default is assumed, thus: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nx">db_set_active</span><span class="p">();</span></code></pre></div>

<p>Hope this helps.</p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/using-additional-database-drupal-7">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/third-most-popular-cms-website-tonight">The Third Most Popular CMS is....Website Tonight</a></h3>		    		
				<p class="meta"> &ndash; 15<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>I noticed something this week while looking at the <a href="http://trends.builtwith.com/cms">latest CMS usage statistics</a> from BuiltWith Trends that surprised me. BuiltWith Trends provides information on the usage of various technologies across the web – including CMS’s, – and it’s of little surprise that they have Wordpress up there at no#1 and Joomla! a little way behind in second. What came as a surprise to me was that up in third was a CMS called “Website Tonight”. That’s ahead of <a href="/blog/categories/drupal">Drupal</a>, which I had always considered one of the “Big Three”. Perhaps tellingly, in separate statistics for the Top Million sites (according to data from Quantcast) it drops down to seventh, and out of the top ten CMS’s altogether when you get to the “top ten websites”. I’ll be honest – I’d never heard of Website Tonight. On its <a href="http://www.starfieldtech.com/products/websitetonight.htm" rel="nofollow" title="The Website Tonight website">inauspicious website</a>, Website Tonight to be: “an Internet-based Web site creation tool that enables users to build and publish Web sites in a few simple steps. An easy-to-use turnkey solution, WebSite Tonight guides the user through the entire process of outlining, building, analyzing, optimizing, and, ultimately, publishing a Web site to the Internet.”. I suspect what’s key on this site is the button entitled “Become a Reseller” – presumably they provide white-label website creation tools for these “build your own website” websites. It does appear that, amongst others, the product is available as a service through <a href="http://www.godaddy.com/hosting/website-builder.aspx" rel="nofollow" title="Godaddy use Website Tonight">the likes of GoDaddy</a>. Either way, it’s a surprising statistic yet one which I don’t believe will affect my decision as to what technology to concentrate on for now – on my head be it! If you happen to know any more about Website Tonight, do let me know in the comments.</p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/third-most-popular-cms-website-tonight">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/facebook-canvas-pages-require-ssl-certificates">Facebook Canvas Pages to Require SSL Certificates</a></h3>		    		
				<p class="meta"> &ndash; 8<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>On the first of October, Facebook will make another change which could have a significant – and potentially costly – impact to your applications and pages. As part of its latest moves to increase security across the platform, in addition to OAuth adoption they will expect that your canvas applications to be hosted at a secure address (https). If a user browses to your page via https – and millions are beginning to change their settings so that they are – instead of your lovingly crafted content, they’ll see the following warning: </p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/facebook-canvas-pages-require-ssl-certificates">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/laravel-php-framework-walkthrough">The Laravel PHP Framework: A Walkthrough</a></h3>		    		
				<p class="meta"> &ndash; 5<sup>th</sup> August, 2011</p>
			</header>
			<div class="body excerpt">      
				<p><a href="http://www.laravel.com">Laravel</a> is the new kid on the block of PHP frameworks, and whilst in its early stages of evolution (the author wrote it, he says, in the early part of 2011) it does promise – and delivers, from what I can tell – an expressive syntax and an elegant (indeed, you might say eloquent) ORM. Laravel is a fully Object Oriented MVC framework which makes extensive use of features new or recent to PHP – you can forget about running it on PHP4. With PHP5.3 compliant namespacing mechanisms as opposed to, for example, Zend Framework’s pseudo-namespacing, it’s certainly what you might call a modern framework. </p>

<h3>Routes</h3>

<p>In Laravel you define routes – which, staying true to the RESTful paradigm, are defined not just as URI’s, but according to the HTTP operation they are to react to. Thus, instead of defining a route such as <code>/about-us</code> you would define a function to respond to a GET request on that URI, which is done using a closure which looks reassuringly like JavaScript:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;GET /about-us&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">()</span>
<span class="p">{</span>        
    <span class="k">return</span> <span class="s1">&#39;some output&#39;</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>Wild-card parameters allow parameters to be passed via the URI, and indeed you can even restrict these to numeric ID’s. So for example, your route definition could look like this: `</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;GET /person/(:num)&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
<span class="p">{</span>        
    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
    <span class="nv">$view</span> <span class="o">=</span> <span class="nx">View</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">);</span>
    <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nv">$user</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$view</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p>Or, you can create a slug using the built-in <code>URL</code> class:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">slug</span> <span class="o">=</span> <span class="nx">URL</span><span class="o">::</span><span class="na">slug</span><span class="p">(</span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">);</span></code></pre></div>

<p>Then switch from <code>:num</code> to <code>:any</code> in your route definition:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;GET /article/(:any)&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$slug</span><span class="p">)</span>
<span class="p">{</span>        
    <span class="c1">// .. find the article identified by slug ...</span>
<span class="p">}</span></code></pre></div>

<p>If you think of the routes definitions as being lightweight controllers, you’ll quickly see from the examples above where the other components of a fully-fledged MVC architecture come in; the ORM (called “Eloquent”) is in action, <em>find</em>ing a User entity with the ID provided from the route, then being <em>bind</em>ed (well, bound) to a <em>View</em>. Moving on from processing GET requests, a process to handle the submission of a form might be defined thus: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;POST /form-submit&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">()</span>
<span class="p">{</span>        
    <span class="c1">// do some processing</span>
    <span class="nx">Redirect</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;Your form submission has been received&#39;</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>Note the fluent interface in the redirection function, allowing a flash message to be passed along the request chain. Nice syntax. Keeping RESTful, a function could be defined to delete a resource using something like this:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;DELETE /person/(:num)/delete&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
<span class="p">{</span>        
    <span class="c1">// .. delete person resource identified by $id ...</span>
    <span class="nx">Redirect</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="o">/</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>I keep talking about the RESTfulness because the first thing that struck me is that it looks a great little framework for quickly scaffolding a web service. While there is not currently any content negotiation built in which would make this even easier, it’s not difficult to see how this could be extended. </p>

<h3>Filters</h3>

<p>One of the things I particularly like about Laravel is that your route definitions can also apply filters to your input (for example CSRF protection or input sanitisation) or on their output. There are a couple of filters built in (for CSRF protection and for authentication) and they can be shared amongst routes. Thus, you could restrict access to a route from unauthorised users thus: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;GET /secure&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;auth&#39;</span><span class="p">,</span> <span class="s1">&#39;do&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span></code></pre></div>

<p>In the example above, the filter <code>auth</code> is to be executed <em>before</em> execution of the route logic (i.e., the closure defined in the ‘do’ element). (The format of the route declaration has changed slightly from the previous, simply because the definition is getting slightly more complex.) The <code>auth</code> filter is defined for you in another closure, this time in the file <code>filters.php</code>: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;auth&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">Auth</span><span class="o">::</span><span class="na">check</span><span class="p">())</span> <span class="o">?</span> <span class="nx">Redirect</span><span class="o">::</span><span class="na">to_login</span><span class="p">()</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
<span class="p">},</span></code></pre></div>

<p>This callback highlights another geature of Laravel; the built-in authentication mechanism, which I’ll cover later – for now, what about that <code>Redirect::to_login()</code> syntax? This leads nicely onto named routes. </p>

<h3>Named Routes</h3>

<p>One of the other features of the routes system designed for developer convenience is the option to create a definition like this: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">&#39;GET /user/login&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;do&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">()</span>
<span class="p">{</span>        
    <span class="k">return</span> <span class="nx">View</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;user/login&#39;</span><span class="p">);</span>
<span class="p">}),</span></code></pre></div>

<p>Now, with the route to <code>user_login</code> assigned the name <code>login</code>, you can start doing this:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">return</span> <span class="nx">Redirect</span><span class="o">::</span><span class="na">to_login</span><span class="p">();</span></code></pre></div>

<p>However, there is more to Laravel than routing; here are some other features that stood out for me. </p>

<h3>The ORM</h3>

<p>Laravel has a built-in Object Relational Mapper (ORM) for data persistance, and provides the Model to the router’s Controller and the Views. Defining a new model using the Eloquent ORM is as simple as this: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">Eloquent</span> <span class="p">{</span> <span class="p">}</span></code></pre></div>

<p>In this example a new model is defined which, unless specified otherwise, expects to find a table named <code>posts</code> (a pluralised, lowercase version of the model’s name) and a primary key named <code>id</code> It’s common to include timestamps on creation and updating; Laravel takes care of this out of the box – all you have to do is add columns called <code>created_at</code> and <code>updated_at</code> (both of the MySQL type <code>TIMESTAMP</code>) to your base table, and the following line in the class definition: `</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">Eloquent</span> <span class="p">{</span>
    
    <span class="k">public</span> <span class="k">static</span> <span class="nv">$timestamps</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span></code></pre></div>

<p>Relationships can be modelled easily and intuitively; as is common across Laravel, if you keep to certain naming conventions then configuration is simple:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">Eloquent</span> <span class="p">{</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">author</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">has_one</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">tags</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">has_and_belongs_to_many</span><span class="p">(</span><span class="s1">&#39;Tag&#39;</span><span class="p">);</span>
    <span class="p">}</span></code></pre></div>

<p>The assumptions here are: 
*   Posts are defined in a table called <code>posts</code> (lower case, pluralised form of the classname)
*   Authors are defined in a table called <code>authors</code>
*   Tags are defined in a table called <code>tags</code>
*   The <code>posts</code> table contains a column called <code>author_id</code>
*   All tables’ primary key columns are called <code>id</code>
*   A foreign key in the <code>tags</code> table is called <code>post_id</code></p>

<h3>Database Support</h3>

<p>In additon to the ORM there is a nice fluent query builder (not dissimilar to Zend, or Drupal 7’s new database abstraction layer), and it’s database-agnostic; there is support currently for SQLite (the Laravel default), the ubiquitous MySQL or Postgres. Configuration for this, as with other areas, is simple – in fact if you’re using SQLite and place your database in the <code>/application/storage/db</code> directory and call it <code>application.sqlite</code>, then it requires no configuration whatsoever. So, for example, you can do this for insertion:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$hits</span> <span class="o">=</span> <span class="nx">Db</span><span class="o">::</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;hits&#39;</span><span class="p">);</span>

<span class="nv">$hits</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="nv">$url</span><span class="p">,</span>
        <span class="s1">&#39;ts&#39;</span> <span class="o">=&gt;</span> <span class="nb">time</span><span class="p">(),</span>
        <span class="s1">&#39;ip_address&#39;</span> <span class="o">=&gt;</span> <span class="nx">Request</span><span class="o">::</span><span class="na">ip</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">);</span></code></pre></div>

<p>Or create queries such as:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nx">DB</span><span class="o">::</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">)</span>
     <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;author_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">)</span>
     <span class="o">-&gt;</span><span class="na">where_in</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;draft&#39;</span><span class="p">,</span> <span class="s1">&#39;unpublished&#39;</span><span class="p">))</span>
     <span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span></code></pre></div>

<p>You can even use what Laravel calls <em>dynamic where methods</em>:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$user</span> <span class="o">=</span> <span class="nx">DB</span><span class="o">::</span><span class="na">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where_email_and_password</span><span class="p">(</span><span class="s1">&#39;hello@lukaswhite.com&#39;</span><span class="p">,</span> <span class="s1">&#39;secret&#39;</span><span class="p">);</span></code></pre></div>

<h3>Simple Configuration</h3>

<p>Configuration is in the form of a collection of files in the <code>/application/config</code> directory, each returning an array of named configuration values. Extending the configuration options is as simple as adding a new file. Add a file called <code>facebook.php</code>, for example: `</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;app_id&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;YOUR_APP_ID_HERE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;YOUR_SECRET_HERE&#39;</span><span class="p">,</span>
<span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<p>...and you can do something like this from anywhere in your code: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$facebook_config</span> <span class="o">=</span> <span class="nx">Config</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;facebook&#39;</span><span class="p">);</span>  <span class="c1">// returns an array of options</span></code></pre></div>

<p>Or you can be more specific:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$api_key</span> <span class="o">=</span> <span class="nx">Config</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;facebook.api_key&#39;</span><span class="p">);</span></code></pre></div>

<p>In keeping with Laravel’s intention to require the minimum possible configuration, the pre-existing configuration files come pre-loaded with sensible default values, but changing any of them is simple. </p>

<h3>An Auth Component</h3>

<p>Authentication is largely taken care of for you by the Auth class; provided you adhere to certain assumptions; users are represented by an “Eloquent” model, there is a <code>password</code> and a column called <code>salt</code> (which is generated for you by the framework&#39;s built-in hashing utility). The identifying column is configurable however, should you wish to allow people to log in using an email address, for example. There is not, at time of writing, an authorisation / ACL model, but the authentication system provided is probably adequate for most small web applications. </p>

<h3>A Data Validation Library</h3>

<p>Data validation is neatly done, with a basic set of generic validators – lengths, inclusion (e.g. checkboxes or radio buttons), regular expression matching or acceptance of (like a checkbox being ticked, e.g. acceptance of terms and conditions) – all with the minimum of configuration. If you call a set of validators without telling it what to validate, it will automatically validate the input (e.g. GET / POST parameters). Again, simplistic, but cover most simple cases – and there’s nothing to stop you from defining your own. </p>

<h3>Text and Inflection Utilities</h3>

<p>There are some fairly standard text-related helper functions for operations such as: </p>

<ul>
<li>  (English) language processing, such as pluralisation</li>
<li>  Character or word-based trimming</li>
<li>  There is even a basic bad-word (“censor”) filter There is also some rudimentary internationalisation support, primarily for translatable strings. </li>
</ul>

<h3>Caching and Logging</h3>

<p>While developing an application with the framework, you can opt to get an error message and a full stack trace in a nicely presented error page. Additionally, logging to a file is simple – change a configuration value or two and set the log files&#39; directory to be writeable. </p>

<h3>Extensibility</h3>

<p>The true test of any framework, arguably, is its extensibility – and overriding or extending framework classes is easy. Everything is namespaced with framework classes aliased, thus: </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$view</span> <span class="o">=</span> <span class="nx">View</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;user/login&#39;</span><span class="p">);</span></code></pre></div>

<p>...would, were it not for aliasing, be:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$view</span> <span class="o">=</span> <span class="nx">System\View</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;user/login&#39;</span><span class="p">);</span></code></pre></div>

<p>The <strong>alias.php</strong> configuration file defines these aliases as a name/value array, e.g.:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;System\\Auth&#39;</span><span class="p">,</span>
    <span class="o">...</span>
    <span class="s1">&#39;View&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;System\\View&#39;</span><span class="p">,</span>
<span class="p">);</span></code></pre></div>

<p>Therefore should you wish, for example, to start using a custom View across your code, a quick re-jig of your aliases and it’s done:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;View&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My\\View&#39;</span><span class="p">,</span>
<span class="p">);</span></code></pre></div>

<h3>Conclusions</h3>

<p>Even after looking closely at Laravel and building a few little applications with it, I stick by my view that it looks like a tool for building web services – but this is no bad thing. In part it’s because some of the things I’ve become accustomed to for web applications aren&#39;t there; managing dependencies (e.g. of Javascript files), layouts, decorators and so on. There are things that are either limited or simple aren&#39;t particularly evolved – the form-building functions (which I’ve not even touched on) are a shadow of those offered by Zend_Form, or Drupal with its Form API, for example – but this is a very new framework and one which will surely evolve. One of the great things about the framework is its learning curve – indeed, I’ve covered a lot of the basics here and if you work through this post you wouldn’t be far off being able to develop a simple application. Configuration is beautifully simple, and whilst certain assumptions can be frustrating at first, if you’re building something from scratch then you’ll soon appreciate how little you actually have to do to get up and running. The main thing that’s not clear nor well documented is the process for extending the functionality; extending the system classes is easy but the packages mechanism is largely undocumented – but packages are starting to appear nonetheless. My view is that the framework would be an excellent introduction to a simple web framework from an O-O minded PHP developer, a promising way to start building a web service and a good way of building a quick prototype for a website or application. Very promising indeed.</p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/laravel-php-framework-walkthrough">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/concrete5-development-tutorial-creating-quote-block">A Concrete5 Development Tutorial; Creating a Quote Block</a></h3>		    		
				<p class="meta"> &ndash; 7<sup>th</sup> July, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>I needed the means to add a quote to a website I was working on – a simple task, which could be acheieved by simply adding a text or HTML block. However this can be taken a step further by implementing a simple block type specifically for quotes, with the markup generated for you. </p>

<p>To mark up a quote semantically, we’ll want a <code>blockquote</code> for the content and a <code>cite</code> for the source (or author), so the HTML needs to look something like this: </p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;blockquote&gt;</span>
<span class="nt">&lt;p&gt;</span>It is the mark of an educated mind to be able to entertain a thought without accepting it.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;&lt;cite&gt;</span>Aristotle<span class="nt">&lt;/cite&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/blockquote&gt;</span></code></pre></div>

<p>...which will give us something a little like this: </p>

<figure class="captioned-image" style="width:600px;"><img src="/images/blogs/2011/concrete5/quotes/concrete5-tutorial-quote.png" width="580" height="225" alt="Concrete5 Module Development Tutorial: the final result" /><figcaption>Our quote will end up looking a little like this (subject to CSS styling!)</figcaption></figure> 

<p>Of course we could just paste this structure into an HTML block, but a simple block containing two fields – content and source – is actually pretty easy to build. So, let’s begin. </p>

<h3>First Steps</h3>

<p>Let’s call the block – imaginatively enough – <strong>quote</strong>. Incorporating this block into a a package is pretty simple, but outside the scope of this tutorial (and I’ve <a href="/blog/post/2011/creating-concrete5-package-integrating-craftyslide-jquery-plugin">covered packages before</a>). So, simply create a directory named <code>quotes</code> in the <code>blocks</code> directory (not the <code>concrete</code> directory – this might mirror the top-level directory structure, but it’s reserved for the core, and would get overwritten with any upgrade). </p>

<h3>The Database Schema</h3>

<p>The first thing we’ll need is to define a new database table to hold our quotes. This simply needs an identifier (which becomes the table’s primary key), the text of the quote (i.e. the content) and the source. Let’s keep the <em>content</em> flexible and allow plenty of text if required, but the <em>source</em> is unlikely to require any more characters than a simple text-field will give us. The database schema in Concrete5 gets defined according to the <a href="http://phplens.com/lens/adodb/docs-datadict.htm">ADOdb XML schema</a>, so a table is defined by creating a simple XML file in your block’s directory which must be called <code>db.xml</code> – and it will look like this: <code>/blocks/quote/db.xml</code> </p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;schema</span> <span class="na">version=</span><span class="s">&quot;0.3&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">name=</span><span class="s">&quot;btQuoteBlockContent&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;bID&quot;</span> <span class="na">type=</span><span class="s">&quot;I&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;key</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;unsigned</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;content&quot;</span> <span class="na">type=</span><span class="s">&quot;C2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;source&quot;</span> <span class="na">type=</span><span class="s">&quot;C&quot;</span> <span class="na">size=</span><span class="s">&quot;255&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/schema&gt;</span></code></pre></div>

<p>So, three fields – <code>bID</code> for the block identifier, which is an unsigned integer (represented by <code>I</code>) – which is the primary key – a <code>content</code> field, which is a Multibyte varchar (see <a href="http://phplens.com/lens/adodb/docs-datadict.htm">the documentation</a>) and the <code>source</code> is a 255-character field (a MySQL <code>varchar</code>, referenced using a <code>C</code>). </p>

<h3>The Add / Edit Forms</h3>

<p>Next up, we need the means to add a new quote. When adding a new block, the file <code>add.php</code> gets rendered, and all we need is a simple form. However since the form for adding a new quote is, to all intents and purposes, the same form as for editing an existing quote, what we can do is simply include a separate file which defines the form – which by convention is called <code>form_setup_html.php</code> – and use the same code for the forms for both adding and editing. So, both <code>add.php</code> and <code>edit.php</code> are identical, and look like this: <code>/blocks/quote/add.php</code> and <code>/blocks/quote/edit.php</code> </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>   
<span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;C5_EXECUTE&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;Access Denied.&quot;</span><span class="p">));</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">inc</span><span class="p">(</span><span class="s1">&#39;form_setup_html.php&#39;</span><span class="p">);</span></code></pre></div>

<p>The first line prevents the file from being accessed directly, the second includes the file which defines the form, which is shown below: </p>

<p><code>/blocks/quote/form_setup_html.php</code> </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;C5_EXECUTE&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;Access Denied.&quot;</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">  </span>
<span class="x">&lt;div&gt;</span>
<span class="x">&lt;h2&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Quote Content&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&lt;/h2&gt;</span>
<span class="x">&lt;textarea id=&quot;ccm-QuoteContent&quot; name=&quot;content&quot; style=&quot;width:98%; height:200px;&quot;&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$content</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/textarea&gt;</span>
<span class="x">&lt;h2&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Quote Source&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&lt;/h2&gt;</span>
<span class="x">&lt;textarea id=&quot;ccm-QuoteSource&quot; name=&quot;source&quot; style=&quot;width:98%; height:100px;&quot;&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$source</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/textarea&gt;</span>
<span class="x">&lt;/div&gt;</span></code></pre></div>

<p>Nothing complicated here, just a form where any current value will have been made available as the variables <code>$content</code> and <code>$source</code> respectively – we’ll see these get populated by examing the next file we need to create, the block controller. </p>

<h3>The Block Controller</h3>

<p><code>/blocks/quote/controller.php</code> `</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>   
<span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;C5_EXECUTE&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;Access Denied.&quot;</span><span class="p">));</span>

<span class="nx">Loader</span><span class="o">::</span><span class="na">block</span><span class="p">(</span><span class="s1">&#39;library_file&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">QuoteBlockController</span> <span class="k">extends</span> <span class="nx">BlockController</span> <span class="p">{</span>
    
    <span class="k">protected</span> <span class="nv">$btTable</span> <span class="o">=</span> <span class="s1">&#39;btQuoteBlockContent&#39;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$btInterfaceWidth</span> <span class="o">=</span> <span class="s2">&quot;600&quot;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$btInterfaceHeight</span> <span class="o">=</span> <span class="s2">&quot;400&quot;</span><span class="p">;</span>
    
    <span class="k">public</span> <span class="nv">$content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getBlockTypeDescription</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">t</span><span class="p">(</span><span class="s2">&quot;Add simple quotes to your website.&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getBlockTypeName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">t</span><span class="p">(</span><span class="s2">&quot;Quote&quot;</span><span class="p">);</span>
    <span class="p">}</span>     
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$obj</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>     
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$obj</span><span class="p">);</span> 
    <span class="p">}</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(){</span> 
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">);</span> 
    <span class="p">}</span> 
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">save</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span> 
        <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">save</span><span class="p">(</span><span class="nv">$args</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<p>There’s quite a lot to go through here, but nothing too complicated. This file sub-classes the <code>BlockController</code> class, which we’ll call <code>QuoteBlockController</code> because our module is called, simply, <strong>quote</strong>. First up, the methods <code>getBlockTypeName()</code> and <code>getBlockTypeDescription()</code> expose information for the administrative interface. The name is used when choosing a block to add, and the description is used in addition to the name when adding new functionality in the dashboard. The line:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">protected</span> <span class="nv">$btTable</span> <span class="o">=</span> <span class="s1">&#39;btQuoteBlockContent&#39;</span><span class="p">;</span></code></pre></div>

<p>...defines a property of our block controller which indicates what database table to use. Once an association is made with a table, operations can be performed on that table using methods such as <code>save</code> within the controller. Also, some functionality – such as querying the table when showing a block – is performed automatically, once the controller knows where to look. The properties <code>$btInterfaceWidth</code> and <code>$btInterfaceHeight</code> control the dimensions of the popup window in the adimistrative interface when adding or editing an instance of our new block. The <code>save</code> method is called when the add or edit forms are submitted, and gets passed an associative array of data from the form; you’ll recognise that the indexes <code>content</code> and <code>source</code> match the names of the form elements previously defined. Calling the parent’s <code>save</code> method with this data will store the information in the table we’ve previously created, because by referring to the table name in the <code>$btTable</code> property we’ve already told the controller where that data goes. Finally, the <code>view</code> method is automatically called when the block is rendered and simply needs to take the properties of the block,<code>content</code> and <code>source</code> – which, by harnessing the power of the blocks system have <em>already been loaded for us</em> are already available as properties of the controller – and assign them to the view. This is achieved using the <code>set</code> method, and as a consequence they will be made available as variables in the view template, <code>view.php</code>, which is shown below. </p>

<h3>The View Template</h3>

<p><code>/blocks/quote/view.php</code> `</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;C5_EXECUTE&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;Access Denied.&quot;</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;div id=&quot;QuoteBlock</span><span class="cp">&lt;?php</span>   <span class="k">echo</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$bID</span><span class="p">)</span><span class="cp">?&gt;</span><span class="x">&quot; class=&quot;QuoteBlock&quot;&gt;</span>
<span class="x">    &lt;blockquote&gt;</span>
<span class="x">    &lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nv">$content</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
<span class="x">    &lt;p&gt;&lt;cite&gt;</span><span class="cp">&lt;?php</span> <span class="k">print</span> <span class="nv">$source</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/cite&gt;&lt;/p&gt;</span>
<span class="x">    &lt;/blockquote&gt;</span>
<span class="x">&lt;/div&gt;</span></code></pre></div>

<p>Pretty simple stuff – and by doing it this way, we ensure that our markup for the quote is exactly as we intended it. </p>

<h3>Installing &amp; Configuring the New Block</h3>

<p>So, if you browse to the Dashboard and select <strong>Add Functionality</strong>, you should see that the new block is available to install under the heading “Downloaded and Ready to Install”. </p>

<figure class="captioned-image" style="width:600px;"><img src="/images/blogs/2011/concrete5/quotes/concrete5-install-module.jpg" width="580" height="200" alt="Concrete5 Module Development Tutorial: installing the new block" /><figcaption>Your new block will appear under the heading “Downloaded and Ready to Install” – click <strong>install</strong></figcaption></figure> 

<p>(Note that the icon displayed alongside the new block type can be personalised; all I’ve done is create a simple 16x16px icon and call it <code>icon.png</code>.) You can now try adding a block; if you scroll to the bottom of the list of available blocks you should see the new block listed: </p>

<figure class="captioned-image" style="width:600px;"><img src="/images/blogs/2011/concrete5/quotes/concrete5-tutorial-add-block.jpg" width="580" height="485" alt="Concrete5 Module Development Tutorial: Adding a block" /><figcaption>At the bottom of the list of available blocks, you’ll notice our new block – *quote* is now available</figcaption></figure> 

<p>Selecting the quote block gives you the form we’ve just created: </p>

<figure class="captioned-image" style="width:600px;"><img src="/images/blogs/2011/concrete5/quotes/concrete5-tutorial-add-quote.jpg" width="580" height="424" alt="Concrete5 Module Development Tutorial: the add / edit form" /><figcaption>This illustrates the form you’ll get when adding a block of type *quote* – enter the content of the quote and its source (author) in the fields provided</figcaption></figure> 

<p>If you enter a quote and its source and then click <strong>add</strong> then, all being well, you should end up with something like the screenshot below. <figure class="captioned-image" style="width:600px;"><img src="/images/blogs/2011/concrete5/quotes/concrete5-tutorial-quote.png" width="580" height="225" alt="Concrete5 Module Development Tutorial: the final result" /><figcaption>The final result – a semantically correct quote</figcaption></figure></p>

<p>(I’ve applied some very basic styling, I’m sure you can do better!) This is an extremely simple example, and I&amp;rsquo&#39;ve left out certain things – such as validation – for brevity, but hopefully it’s enough to give you an idea of how easy it is to create functionality like this and to get started developing for Concrete5.</p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/concrete5-development-tutorial-creating-quote-block">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/creating-concrete5-package-integrating-craftyslide-jquery-plugin">Creating a Concrete5 Package: Integrating the Craftyslide JQuery Plugin</a></h3>		    		
				<p class="meta"> &ndash; 5<sup>th</sup> July, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>In this simple tutorial, I’m going to show how Concrete5 can be extended to integrate a third-party JQuery plugin to enhance an existing module, and then how this can be encapsulated in a package. I’m going to allow the <strong>slideshow</strong> module to display images using the clean &amp; lightweight <a href="http://projects.craftedpixelz.co.uk/craftyslide/index.php">Craftyslide</a> plugin, pictured below. </p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/creating-concrete5-package-integrating-craftyslide-jquery-plugin">Read more &raquo;</a></p>
			</footer>
		</article>
		
		<article class="post clearfix">
			<header>
				<h3><a href="/blog/post/2011/taxonomy-colour-drupal-module-development-tutorial-part-two">Taxonomy Colour: Drupal Module Development Tutorial (Part Two)</a></h3>		    		
				<p class="meta"> &ndash; 4<sup>th</sup> July, 2011</p>
			</header>
			<div class="body excerpt">      
				<p>In the <a href="/blog/post/2010/taxonomy-colour-drupal-module-development-tutorial-part-one">first part</a>, I looked at creating the database schema for a simple Drupal module designed to allow you to associate colours with taxonomy terms. In this second part, I’ll look at the administration aspects of the module. In essence, what we need to do is as follows: </p>

<ul>
<li>  Since colour-coding may only be appropriate to certain vocabularies (e.g. categories) and not others (tags, perhaps). We need to provide the user with the option to specify which vocabularies are applicable.</li>
<li>  The user needs to be able to specify a colour when adding or editing a term, where appropriate.</li>
<li>  We need to provide a mechanism which allows the colour associated with a term to be stored, retrieved, and to be displayed. </li>
</ul>

<p>Later, I’m going to want to incorporate the colour in views, as well as consider some performance aspects. The next thing, then, is to start coding the module and this will take place in the PHP file we created in part one, <code>taxonomy_color.module</code>. </p>

<h3>Introducing hook_form_alter</h3>

<p>To allow the option to categorise terms on a per-vocabulary basis, we&#39;ll add a checkbox to the edit vocabulary form (which is also used to add a new vocabulary). We achieve this by harnessing the power of <code>hook_form_alter</code>. In order to intercept the form and add this checkbox, we need to create a method whose name matches the signature <code>hook_form_FORM_ID_alter</code>. The first part of this tutorial introduced hooks, and I introduced the idea that the the <code>hook</code> part should be replaced by the ID of the module, thus: <code>taxonomy_color_form_FORM_ID_alter</code>. To find our form ID, the easiest way is to get the form on screen by navigating to the relevant page (in this case, go and edit an existing term), <strong>view source</strong> and check the ID of the <code>form</code> tag: </p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;/admin/content/taxonomy/edit/vocabulary/1&quot;</span>  <span class="na">accept-charset=</span><span class="s">&quot;UTF-8&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">id=</span><span class="s">&quot;taxonomy-form-vocabulary&quot;</span><span class="nt">&gt;</span></code></pre></div>

<p>You’ll see that this is <code>taxonomy-form-vocabulary</code> – we must then, however, get rid of those dashes and replace them with underscores, i.e. <code>taxonomy_form_vocabulary</code> – so the method name becomes: <code>taxonomy_color_form_taxonomy_form_vocabulary_alter</code> Quite a mouthful, huh? This mechanism for determining your function name might seem unwieldy and complicated, but you soon get the hang of it. Consulting the <a href="http://api.drupal.org/api/drupal/developer--hooks--core.php/function/hook_form_FORM_ID_alter/6">documentation</a> / source for <code>hook_form_FORM_ID_alter</code> shows that the method should look like this:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="sd">/**</span>
<span class="sd"> * Implementation of hook_form_FORM_ID_alter().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_form_taxonomy_form_vocabulary_alter</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
 <span class="c1">// implementation goes here</span>
<span class="p">}</span></code></pre></div>

<p>So, let&#39;s start implementing the function by adding the form element.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;checkbox&#39;</span><span class="p">,</span>
          <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Use colour-coding&#39;</span><span class="p">),</span>
          <span class="s1">&#39;#default_value&#39;</span> <span class="o">=&gt;</span> <span class="nv">$checked</span><span class="p">,</span>      
        <span class="p">);</span></code></pre></div>

<p>Once you’ve added this new element, the form should look something like the figure below: </p>

<figure class="captioned-image" style="width:600px;"> <img src="/images/blogs/2011/taxonomy/taxonomy-color-vocab-form-1.png" width="580" height="400" alt="" /><figcaption>The Add / Edit Vocabulary form, after we've added a new checkbox (“Use colour-coding”)</figcaption></figure> 

<p>You’ll probably notice a minor issue immediately – the new element sits below the <em>Save</em> (i.e. the submit) and <em>Delete</em> buttons. Whilst the form is still fully functional, it’ not ideal from a usability point-of-view. In order to fix this we juggle the weights, which control the order in which elements appear within a form. Let’s first set the weight – configured as an element of the array that represents the element – to a high number, thus:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;checkbox&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Use colour-coding&#39;</span><span class="p">),</span>
    <span class="s1">&#39;#default_value&#39;</span> <span class="o">=&gt;</span> <span class="nv">$checked</span><span class="p">,</span>      
    <span class="s1">&#39;#weight&#39;</span> <span class="o">=&gt;</span> <span class="mi">999</span><span class="p">,</span> 
  <span class="p">);</span></code></pre></div>

<p>And then change the weights of the <em>Save</em> (the submit) and <em>Delete</em> buttons to greater values (the greater the value, the further down the form the element will appear), thus:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1001</span><span class="p">;</span></code></pre></div>

<p>The form should now be re-ordered, as illustrated by the figure below: </p>

<figure class="captioned-image" style="width:600px;"> <img src="/images/blogs/2011/taxonomy/taxonomy-color-vocab-form-2.png" width="580" height="170" alt="" /><figcaption>The amended form, now we’ve juggled the weights around</figcaption></figure> 

<p>I won’t go into the mechanics of the Drupal Form API – you may wish to refer to the <a href="http://drupal.org/node/751826">Form API Quickstart Guide</a> – but we&#39;re basically adding a new element called <em>color</em>, which is a checkbox with the given caption (the <code>t()</code> function – which stands for translate – allows us to localise our titles and messages). Now, the other element which so far I’ve just skimmed over - the <code>default_value</code> element. In truth this is probably easier to think of as an <em>initial</em> value; when adding a new vocabulary it’s a default value but when editing it’s the <em>current</em> value. But before we can set this value, we need to decide where it’ going to get stored. </p>

<h3>Using Variables in Drupal</h3>

<p>Creating a table to hold these values is probably overkill, however Drupal provides simple key-value storage via the <code>variable</code> system, so that’s what we&#39;ll do. What I’m going to do, then, is simply have a variable for each vocabulary indicating whether to apply a colour scheme or not. Sticking with the convention of prefixing everything with the module name to ensure it’s unique, I’ve stumped for taxonomy_color_color_vocab_<em>vid</em>, where <em>vid</em> is the vocabulary ID. So the value of <code>$default</code> is determined as follows:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;vid&#39;</span><span class="p">][</span><span class="s1">&#39;#value&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$checked</span> <span class="o">=</span> <span class="nx">variable_get</span><span class="p">(</span><span class="s1">&#39;taxonomy_color_color_vocab_&#39;</span><span class="o">.</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;vid&#39;</span><span class="p">][</span><span class="s1">&#39;#value&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$checked</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>

<p>If we’re editing a vocabulary (rather than adding), the vid is stored in <code>$form[&#39;vid&#39;][&#39;#value&#39;]</code> – do a <code>var_dump()</code> to see this – so in the first case, we find out the current value for the given vocabulary, first appending the vid to the key. The second argument to the function <code>variable_get</code> specifies the value to return if the key in question doesn&#39;t have a value – 0 (false) seems a sensible default. If the vid isn’t set then it– a new vocabulary, so let’ set it to false. </p>

<h3>Using hook_taxonomy</h3>

<p>Next up, this value needs to be stored at the appropriate time – in this case when the form gets submitted; however there’s a trick we can use to “hook in” to this part of the process; when a vocabulary is inserted or updated. We’re going to use another hook – <code>hook_taxonomy()</code>:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="sd">/**</span>
<span class="sd"> * Implementation of hook_taxonomy().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_taxonomy</span><span class="p">(</span><span class="nv">$op</span><span class="p">,</span> <span class="nv">$type</span><span class="p">,</span> <span class="nv">$form_values</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span></code></pre></div>

<p>This function gets called when inserting, updating or deleting a vocabulary or a term. <code>$op</code> indicates the operation (<em>insert</em>, <em>update</em> or <em>delete</em>), and the second argument – <code>$type</code> – indicates whether the entity in question is either a <em>term</em> or <em>vocabulary</em>. Here’s the implementation:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">switch</span> <span class="p">(</span><span class="nv">$type</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="k">case</span> <span class="s1">&#39;vocabulary&#39;</span><span class="o">:</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nv">$op</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;insert&#39;</span><span class="o">:</span>
                <span class="k">case</span> <span class="s1">&#39;update&#39;</span><span class="o">:</span>
                    <span class="nx">variable_set</span><span class="p">(</span><span class="s1">&#39;taxonomy_color_color_vocab_&#39;</span><span class="o">.</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;vid&#39;</span><span class="p">],</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]));</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
                    <span class="nx">variable_del</span><span class="p">(</span><span class="s1">&#39;taxonomy_color_color_vocab_&#39;</span><span class="o">.</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;vid&#39;</span><span class="p">]);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            
            <span class="k">break</span><span class="p">;</span></code></pre></div>

<p>We’re interested in vocabularies right now - but we&#39;ll use a <code>switch</code> here because in a moment, we’ll be looking at terms. Another <code>switch</code> decides what to do based on the operation; setting the variable we defined previously on an insert or an update, and if we’re deleting a vocabulary then let’s keep things tidy by deleting the corresponding variable. </p>

<h3>Assigning Colour to Taxonomy Terms</h3>

<p>Next up, we need to add the option to specify a colour for a given taxonomy term by adding a new field to the term edit form. Again, we achieve this using <code>hook_form_alter</code>, adding a new fieldset containing a textfield. Ideally we’d probably want to use JQuery to transform this element into a colour picker, but that’s outside the scope of this tutorial. So, once again we have a look at the form to get the form ID:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;/admin/content/taxonomy/edit/term/123&quot;</span>  <span class="na">accept-charset=</span><span class="s">&quot;UTF-8&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">id=</span><span class="s">&quot;taxonomy-form-term&quot;</span> <span class="na">enctype=</span><span class="s">&quot;multipart/form-data&quot;</span><span class="nt">&gt;</span></code></pre></div>

<p>So by applying the same logic as before, our function name becomes: <code>taxonomy_color_form_taxonomy_form_term_alter</code> By inspecting the form we can see that the term ID (tid) is stored in <code>$form[&#39;tid&#39;][&#39;#value&#39;]</code>, so we can check for a colour associated with that term ID, otherwise defaulting to black (hex 000000). This is shown in the snippet below.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$tid</span> <span class="o">=</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">][</span><span class="s1">&#39;#value&#39;</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$tid</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="nx">taxonomy_color_get_term_color</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="s1">&#39;000000&#39;</span><span class="p">;</span>
  <span class="p">}</span></code></pre></div>

<p>You’ll probably notice immediately that I’ve called a function which I haven’t yet defined; its purpose should be self explanatory. Let’s dive in:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">function</span> <span class="nf">taxonomy_color_get_term_color</span><span class="p">(</span><span class="nv">$tid</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nx">db_fetch_object</span><span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;SELECT color FROM {term_color} WHERE tid = &#39;%d&#39;&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_object</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">color</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">NULL</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>The SQL should be fairly clear; we run that query, substituting the provided term ID (tid) and fetch the result as an object. The <code>db_query</code> function provides an API to our database. Note that the table name is wrapped in curly braces; if a table prefix was allocated upon installation, this will be inserted for us – it’s not safe to just assume the table is called <code>term_color</code>. And here is the rest of <code>taxonomy_color_form_taxonomy_form_term_alter</code></p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="sd">/**</span>
<span class="sd"> * Implementation of hook_form_FORM_ID_alter().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_form_taxonomy_form_term_alter</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
<span class="nv">$vid</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;#vocabulary&#39;</span><span class="p">][</span><span class="s1">&#39;vid&#39;</span><span class="p">]);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">variable_get</span><span class="p">(</span><span class="s1">&#39;taxonomy_color_color_vocab_&#39;</span><span class="o">.</span><span class="nv">$vid</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>  
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span>
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  
  <span class="nv">$tid</span> <span class="o">=</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">][</span><span class="s1">&#39;#value&#39;</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$tid</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="nx">taxonomy_color_get_term_color</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="s1">&#39;000000&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;extras&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;fieldset&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Extras&#39;</span><span class="p">),</span>
    <span class="s1">&#39;#collapsible&#39;</span> <span class="o">=&gt;</span> <span class="k">TRUE</span><span class="p">,</span>
  <span class="p">);</span>
    
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;extras&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;textfield&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">),</span>
    <span class="s1">&#39;#size&#39;</span> <span class="o">=&gt;</span>  <span class="mi">6</span><span class="p">,</span>
    <span class="s1">&#39;#default_value&#39;</span> <span class="o">=&gt;</span> <span class="nv">$color</span><span class="p">,</span>
    <span class="s1">&#39;#description&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;The Color that represents this term.&#39;</span><span class="p">),</span>
  <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>Note that before we modify the form, we check whether the vocabulary of this term uses colour-coding; whether editing or adding a brand new term the vocabulary is, by design, already specified and is stored in <code>$form[&#39;#vocabulary&#39;][&#39;vid&#39;]</code> so we use this to check the value of the relevant variable. </p>

<h3>Using the Database in Drupal</h3>

<p>So, that’s the form modified, but we still need to store the colour in the table we created. Here we’ll go back to our implementation of <code>hook_taxonomy()</code>, and add a clause to the <code>switch</code> statement to pick up on term changes.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">function</span> <span class="nf">taxonomy_color_taxonomy</span><span class="p">(</span><span class="nv">$op</span><span class="p">,</span> <span class="nv">$type</span><span class="p">,</span> <span class="nv">$form_values</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">...</span>
  <span class="k">case</span> <span class="s1">&#39;term&#39;</span><span class="o">:</span>
<span class="sb">` If the form contains a term ID (tid), we check the operation being performed, which is stored in `</span><span class="nv">$op</span><span class="sb">`. The function continues as follows: `</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="c1">// grab the tid  </span>
    <span class="nv">$tid</span> <span class="o">=</span> <span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">];</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nv">$op</span><span class="p">)</span> <span class="p">{</span>
<span class="sb">` If the term is being inserted or updated, `</span><span class="nv">$op</span><span class="sb">` will be **insert** or **update** respectively, but we’ll handle them with the same function: `</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nv">$op</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s1">&#39;insert&#39;</span><span class="o">:</span>
      <span class="k">case</span> <span class="s1">&#39;update&#39;</span><span class="o">:</span>
        <span class="c1">// if we&#39;re inserting or updating, set the color</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]))</span> <span class="p">{</span>
          <span class="nx">taxonomy_color_add</span><span class="p">(</span><span class="nv">$tid</span><span class="p">,</span> <span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]);</span>
        <span class="p">}</span>        
        <span class="k">break</span><span class="p">;</span>
<span class="sb">` There’s a new function here – `</span><span class="nx">taxonomy_color_add</span><span class="sb">` – but let’s just finish this function before addressing that: `</span>
      <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
        <span class="c1">// delete the appropriate row in term_color</span>
        <span class="nx">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>

<p>So as you can see, the next step is to define functions to add / update / delete a colour for a given term. Deleting is easy:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="sd">/**</span>
<span class="sd"> * Delete the color associated with a given term</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM {term_color} WHERE tid=&#39;%d&#39;&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">);</span>
<span class="p">}</span>
<span class="sb">` It might appear that I&#39;m making adding a colour for a given term more complicated than it needs to be, by deleting a record and inserting a new one instead of updating; however by doing it this way I’m keeping on top of enforcing the integrity of the cache, a new aspect to the module which you’ll see being introduced in this function: `</span>
<span class="k">function</span> <span class="nf">taxonomy_color_add</span><span class="p">(</span><span class="nv">$tid</span><span class="p">,</span> <span class="nv">$color</span><span class="p">)</span> <span class="p">{</span>

  <span class="nv">$count</span> <span class="o">=</span> <span class="nx">db_result</span><span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(tid) FROM {term_color} WHERE tid=%d&#39;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Delete old color before saving the new one.</span>
    <span class="nx">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO {term_color} (tid, color) VALUES (&#39;%d&#39;, &#39;%s&#39;)&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">,</span> <span class="nv">$color</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">cache_clear_all</span><span class="p">(</span><span class="s2">&quot;taxonomy_color:</span><span class="si">$tid</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;cache_tax_color&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>As you can see, when we delete a colour held against a term and add a new one, we clear any record for this term from the cache, where the key is <code>taxonomy_color:tid</code>. The second parameter of the call to <code>cache_clear_all</code> is the name of the table used to store the cached data. Note that I could / should use <code>drupal_write_record</code> here, but I’m going to keep it simple for now. </p>

<h3>The Module (so far) in Full</h3>

<p>Below, you’ll find the module in full, at least up until this point. </p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="sd">/**</span>
<span class="sd"> * @file</span>
<span class="sd"> * Enables colors to be assigned to taxonomy</span>
<span class="sd"> *</span>
<span class="sd"> * @author Lukas White &lt;hello@lukaswhite.com&gt;</span>
<span class="sd"> */</span>

<span class="sd">/**</span>
<span class="sd"> * Implementation of hook_perm().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_perm</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;administer taxonomy&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Implementation of hook_form_FORM_ID_alter().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_form_taxonomy_form_term_alter</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$form</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$form_state</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span>
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">][</span><span class="s1">&#39;#weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  
  <span class="nv">$tid</span> <span class="o">=</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">][</span><span class="s1">&#39;#value&#39;</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$tid</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="nx">taxonomy_color_get_term_color</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$color</span> <span class="o">=</span> <span class="s1">&#39;000000&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;extras&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;fieldset&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Extras&#39;</span><span class="p">),</span>
    <span class="s1">&#39;#collapsible&#39;</span> <span class="o">=&gt;</span> <span class="k">TRUE</span><span class="p">,</span>
  <span class="p">);</span>
    
  <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;extras&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;#type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;textfield&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#title&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">),</span>
    <span class="s1">&#39;#size&#39;</span> <span class="o">=&gt;</span>  <span class="mi">6</span><span class="p">,</span>
    <span class="s1">&#39;#default_value&#39;</span> <span class="o">=&gt;</span> <span class="nv">$color</span><span class="p">,</span>
    <span class="s1">&#39;#description&#39;</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">(</span><span class="s1">&#39;The Color that represents this term.&#39;</span><span class="p">),</span>
  <span class="p">);</span>
  
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Implementation of hook_taxonomy().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_taxonomy</span><span class="p">(</span><span class="nv">$op</span><span class="p">,</span> <span class="nv">$type</span><span class="p">,</span> <span class="nv">$form_values</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// We&#39;re only interested in term changes.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">!=</span> <span class="s1">&#39;term&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="c1">// grab the tid  </span>
    <span class="nv">$tid</span> <span class="o">=</span> <span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;tid&#39;</span><span class="p">];</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nv">$op</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s1">&#39;insert&#39;</span><span class="o">:</span>
      <span class="k">case</span> <span class="s1">&#39;update&#39;</span><span class="o">:</span>
        <span class="c1">// if we&#39;re inserting or updating, set the color</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]))</span> <span class="p">{</span>
          <span class="nx">taxonomy_color_add</span><span class="p">(</span><span class="nv">$tid</span><span class="p">,</span> <span class="nv">$form_values</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]);</span>
        <span class="p">}</span>        
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
        <span class="c1">// delete the appropriate row in term_color</span>
        <span class="nx">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Helper function for adding a colour to a term</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_add</span><span class="p">(</span><span class="nv">$tid</span><span class="p">,</span> <span class="nv">$color</span><span class="p">)</span> <span class="p">{</span>

  <span class="nv">$count</span> <span class="o">=</span> <span class="nx">db_result</span><span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(tid) FROM {term_color} WHERE tid=%d&#39;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Delete old color before saving the new one.</span>
    <span class="nx">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO {term_color} (tid, color) VALUES (&#39;%d&#39;, &#39;%s&#39;)&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">,</span> <span class="nv">$color</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">cache_clear_all</span><span class="p">(</span><span class="s2">&quot;taxonomy_color:</span><span class="si">$tid</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;cache_tax_color&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">taxonomy_color_get_term_color</span><span class="p">(</span><span class="nv">$tid</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nx">db_fetch_object</span><span class="p">(</span><span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;SELECT color FROM {term_color} WHERE tid = &#39;%d&#39;&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_object</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">color</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Delete the color associated with a given term</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_delete</span><span class="p">(</span><span class="nv">$tid</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">db_query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM {term_color} WHERE tid=&#39;%d&#39;&quot;</span><span class="p">,</span> <span class="nv">$tid</span><span class="p">);</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> *  Implementation of hook_flush_caches().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_flush_caches</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;cache_tax_color&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> *  Implementation of hook_views_api().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_views_api</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;api&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nx">drupal_get_path</span><span class="p">(</span><span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonomy_color&#39;</span><span class="p">),</span>
    <span class="p">);</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> *  Implementation of hook_views_handlers().</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">taxonomy_color_views_handlers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;info&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nx">drupal_get_path</span><span class="p">(</span><span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonomy_color&#39;</span><span class="p">),</span>
      <span class="p">),</span>
    <span class="s1">&#39;handlers&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">&#39;views_handler_field_taxonomy_color&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;parent&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;views_handler_field&#39;</span><span class="p">,</span>
        <span class="p">),</span>
      <span class="p">),</span>
    <span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>In the next part, I’ll complete the module by implementing caching fully, and then adding Views integration.</p>

			</div>
			<footer>
				<p class="readmore"><a href="/blog/post/2011/taxonomy-colour-drupal-module-development-tutorial-part-two">Read more &raquo;</a></p>
			</footer>
		</article>
		

		<!-- Pagination links -->
		<div class="pagination">
			
				
				<a href="/blog/page2" class="previous">Previous</a>
				
			
			<span class="page_number ">Page 3 of 4</span>
			
			<a href="/blog/page4" class="next">Next</a>
			
		</div>

	</div>
		 <aside class="five columns">		 	
			
			<h4>About Me</h4>

<p>I&#39;m a web developer based in Manchester, England. I also design websites.  I generally favour open-source technologies such as PHP, MySQL and JQuery, and I have extensive experience using Drupal.</p>
		 	
		 </aside>

		 <aside class="five columns">
			<div class="block tag-cloud">
			 	<h4>Tags</h4>
			 	<ul class="tags">
				
	    		<li><a href="/blog/tags/drupal">Drupal</a></li>
				
	    		<li><a href="/blog/tags/mobile">mobile</a></li>
				
	    		<li><a href="/blog/tags/rwd">RWD</a></li>
				
	    		<li><a href="/blog/tags/responsive-web-design">responsive web design</a></li>
				
	    		<li><a href="/blog/tags/deployment">deployment</a></li>
				
	    		<li><a href="/blog/tags/prowl">Prowl</a></li>
				
	    		<li><a href="/blog/tags/push-notifications">push notifications</a></li>
				
	    		<li><a href="/blog/tags/concrete5">Concrete5</a></li>
				
	    		<li><a href="/blog/tags/cms">CMS</a></li>
				
	    		<li><a href="/blog/tags/tutorials">tutorials</a></li>
				
	    		<li><a href="/blog/tags/php">PHP</a></li>
				
	    		<li><a href="/blog/tags/laravel">Laravel</a></li>
				
	    		<li><a href="/blog/tags/frameworks">frameworks</a></li>
				
	    		<li><a href="/blog/tags/facebook">Facebook</a></li>
				
	    		<li><a href="/blog/tags/drupal-7">Drupal 7</a></li>
				
	    		<li><a href="/blog/tags/ux">UX</a></li>
				
	    		<li><a href="/blog/tags/less">Less</a></li>
				
	    		<li><a href="/blog/tags/mysql">MySQL</a></li>
				
	    		<li><a href="/blog/tags/writing">writing</a></li>
				
	    		<li><a href="/blog/tags/sitepoint">Sitepoint</a></li>
				
	    		<li><a href="/blog/tags/articles">articles</a></li>
				
	    		<li><a href="/blog/tags/spotify">Spotify</a></li>
				
	    		<li><a href="/blog/tags/drupal-commerce">Drupal Commerce</a></li>
				
	    		<li><a href="/blog/tags/bash">Bash</a></li>
				
	    		<li><a href="/blog/tags/git">Git</a></li>
				
	    		<li><a href="/blog/tags/apache">Apache</a></li>
				
	    		<li><a href="/blog/tags/workflow">Workflow</a></li>
				
	    		<li><a href="/blog/tags/foundation">Foundation</a></li>
				
	    		<li><a href="/blog/tags/gravatar">Gravatar</a></li>
				
	    		<li><a href="/blog/tags/jquery">JQuery</a></li>
				
	    		<li><a href="/blog/tags/geo">Geo</a></li>
				
	    		<li><a href="/blog/tags/backbone">Backbone</a></li>
				
	    		<li><a href="/blog/tags/homestead">Homestead</a></li>
				
	    		<li><a href="/blog/tags/elasticsearch">Elasticsearch</a></li>
				
	    		<li><a href="/blog/tags/jekyll">Jekyll</a></li>
				
	    		<li><a href="/blog/tags/grunt">Grunt</a></li>
				
				</ul>
			</div>
		 </aside>
</div>  
 
  </div>

  <!-- Footer begins ========================================================================== -->
  <footer id="footer">
    <hr>
    <div class="eight columns">
      <ul id="footerLinks">
        <li>&copy; 2014 Lukas White. All rights reserved.</li>        
        <li><a href="http://www.twitter.com/lukaswhite" target="_blank">@lukaswhite</a></li>              
      </ul>
    </div>
    <div class="eight columns right">
      <ul class="social small">
        <li><a class="linkedin" href="http://uk.linkedin.com/in/lukaswhite" target="_blank"><span>View my LinkedIn Profile</span></a></li>
        <li><a class="twitter" href="http://www.twitter.com/lukaswhite" target="_blank"><span>Follow me on Twitter</span></a></li>
        <li><a class="facebook" href="http://www.facebook.com/lukas.white.freelance.web.developer" target="_blank"><span>Find me on Facebook</span></a></li>
        <li><a class="github" href="https://github.com/lukaswhite" target="_blank"><span>Find me on Github</span></a></li>
      </ul>
    </div>
    <hr>
    <div class="sixteen columns centered">
      <p>Powered by <a href="http://www.typeandgrids.com" target="_blank">Type &amp; Grids</a>, <a href="http://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/erikhuda/thor">Thor</a></p>
    </div>
  </footer>
  <!-- Footer ends ============================================================================ -->
    
</div><!-- container -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3485550-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>